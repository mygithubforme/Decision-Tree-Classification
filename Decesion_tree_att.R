

#load all data files
data = read.csv(file = "D:\\UTA\\5334\\Proj 1\\att.csv", header = FALSE, sep = ',')
accuracy=0
for(i in 1:5)#for Round 5
{
  if(i==1)
  {
    print("Round 1 --------------------------------------------------------------------------")
    test = data[c(1:2,11:12,21:22,31:32,41:42,51:52,61:62,71:72,81:82,91:92,101:102,111:112,121:122,131:132,141:142,151:152,161:162,171:172,181:182,191:192,201:202,211:212,221:222,231:232,241:242,251:252,261:262,271:272,281:282,291:292,301:302,311:312,321:322,331:332,341:342,351:352,361:362,371:372,381:382,391:392),]
    train=data[c(3:10,13:20,23:30,33:40,43:50,53:60,63:70,73:80,83:90,93:100,103:110,113:120,123:130,133:140,143:150,153:160,163:170,173:180,183:190,193:200,203:210,213:220,223:230,233:240,243:250,253:260,263:270,273:280,283:290,293:300,303:310,313:320,323:330,333:340,343:350,353:360,363:370,373:380,383:390,393:400),]
    
  }
  else if(i==2)
  {
    print("Round 2 --------------------------------------------------------------------------")
    test = data[c(3:4,13:14,23:24,33:34,43:44,53:54,63:64,73:74,83:84,93:94,103:104,113:114,123:124,133:134,143:144,153:154,163:164,173:174,183:184,193:194,203:204,213:214,223:224,233:234,243:244,253:254,263:264,273:274,283:284,293:294,303:304,313:314,323:324,333:334,343:344,353:354,363:364,373:374,383:384,393:394),]
    train=data[c(1:2,5:12,15:22,25:32,35:42,45:52,55:62,65:72,75:82,85:92,95:102,105:112,115:122,125:132,135:142,145:152,155:162,165:172,175:182,185:192,195:202,205:212,215:222,225:232,235:242,245:252,255:262,265:272,275:282,285:292,295:302,305:312,315:322,325:332,335:342,345:352,355:362,365:372,375:382,385:392,395:400),]
    
  }
  else if(i==3)
  {
    print("Round 3 --------------------------------------------------------------------------")
    test = data[c(5:6,15:16,25:26,35:36,45:46,55:56,65:66,75:76,85:86,95:96,105:106,115:116,125:126,135:136,145:146,155:156,165:166,175:176,185:186,195:196,205:206,215:216,225:226,235:236,245:246,255:256,265:266,275:276,285:286,295:296,305:306,315:316,325:326,335:336,345:346,355:356,365:366,375:376,385:386,395:396),]
    train=data[c(1:4,7:14,17:24,27:34,37:44,47:54,57:64,67:74,77:84,87:94,97:104,107:114,117:124,127:134,137:144,147:154,157:164,167:174,177:184,187:194,197:204,207:214,217:224,227:234,237:244,247:254,257:264,267:274,277:284,287:294,297:304,307:314,317:324,327:334,337:344,347:354,357:364,367:374,377:384,387:394,397:400),]
    
  }
  else if(i==4)
  {
    print("Round 4 --------------------------------------------------------------------------")
    test = data[c(7:8,17:18,27:28,37:38,47:48,57:58,67:68,77:78,87:88,97:98,107:108,117:118,127:128,137:138,147:148,157:158,167:168,177:178,187:188,197:198,207:208,217:218,227:228,237:238,247:248,257:258,267:268,277:278,287:288,297:298,307:308,317:318,327:328,337:338,347:348,357:358,367:368,377:378,387:388,397:398),]
    train=data[c(1:6,9:16,19:26,29:36,39:46,49:56,59:66,69:76,79:86,89:96,99:106,109:116,119:126,129:136,139:146,149:156,159:166,169:176,179:186,189:196,199:206,209:216,219:226,229:236,239:246,249:256,259:266,269:276,279:286,289:296,299:306,309:316,319:326,329:336,339:346,349:356,359:366,369:376,379:386,389:396,399:400),]
    
  }
  else
  {
    print("Round 5 --------------------------------------------------------------------------")
    test = data[c(9:10,19:20,29:30,39:40,49:50,59:60,69:70,79:80,89:90,99:100,109:110,119:120,129:130,139:140,149:150,159:160,169:170,179:180,189:190,199:200,209:210,219:220,229:230,239:240,249:250,259:260,269:270,279:280,289:290,299:300,309:310,319:320,329:330,339:340,349:350,359:360,369:370,379:380,389:390,399:400),]
    train=data[c(1:8,11:18,21:28,31:38,41:48,51:58,61:68,71:78,81:88,91:98,101:108,111:118,121:128,131:138,141:148,151:158,161:168,171:178,181:188,191:198,201:208,211:218,221:228,231:238,241:248,251:258,261:268,271:278,281:288,291:298,301:308,311:318,321:328,331:338,341:348,351:358,361:368,371:378,381:388,391:398),]
  }
#print (test)
#creating model using totalTrainingset
model1 = rpart(V645 ~ ., train, method = 'class')
plot(model1)
text(model1)
printcp(model1)
predicted1 = predict(model1, test, type='class')
table(predicted1,test$V645)
#printing the accuracy of our model. it's in percentage
accuracy1=mean(predicted1 == test[ , "V645"])*100 
accuracy=accuracy+accuracy1
print("Round Accuracy:")
print(accuracy1)
}

print("Overall acuuracy")
avg_accuracy=accuracy/5
print(avg_accuracy)



